(function(){for(var t,e=null,r="core",n=document.getElementsByTagName("script"),o=0;o<n.length;o++){var i=n[o].src.replace(/%20/g,"").match(/^(.*?)mxn\.js(\?\(\[?(.*?)\]?\))?$/);if(null!==i){if(t=i[1],i[3]){var a=i[3].split(",[");e=a[0].replace("]",""),a[1]&&(r+=","+a[1])}break}}if(null!==e&&"none"!=e){e=e.replace(/ /g,"").split(","),r=r.replace(/ /g,"").split(",");var l='<script type="text/javascript" src="'+t+"mxn.",s='.js"></script>',u=[];for(o=0;o<r.length;o++){u.push(l+r[o]+s);for(var c=0;c<e.length;c++)u.push(l+e[c]+"."+r[o]+s)}document.write(u.join(""))}})(),function(){var t={},e=function(e,o,i,a,l){if(!r(e,o,i))throw"Method "+i+" of object "+o+" is not supported by API "+e+". Are you missing a script tag?";if(void 0===t[e][o].deferrable||!0!==t[e][o].deferrable[i])return t[e][o][i].apply(a,l);n.deferUntilLoaded.call(a,function(){return t[e][o][i].apply(a,l)})},r=function(e,r,n){if(void 0===t[e])throw"API "+e+" not loaded. Are you missing a script tag?";if(void 0===t[e][r])throw"Object definition "+r+" in API "+e+" not loaded. Are you missing a script tag?";return"function"==typeof t[e][r][n]},n=window.mxn={register:function(e,r){t.hasOwnProperty(e)||(t[e]={}),n.util.merge(t[e],r)},addProxyMethods:function(t,e,r){for(var n=0;n<e.length;n++){var o=e[n];t.prototype[o]=r?new Function("return this.invoker.go('"+o+"', arguments, { overrideApi: true } );"):new Function("return this.invoker.go('"+o+"', arguments);")}},checkLoad:function(t){if(!1===this.loaded[this.api]){var e=this;return this.onload[this.api].push(function(){t.callee.apply(e,t)}),!0}return!1},deferUntilLoaded:function(t){if(!1===this.loaded[this.api]){this.onload[this.api].push(t)}else t.call(this)},addEvents:function(t,e){for(var r=0;r<e.length;r++){var o=e[r];if(o in t)throw"Event or method "+o+" already declared.";t[o]=new n.Event(o,t)}}};n.Event=function(t,e){var r=[];if(!t)throw"Event name must be provided";this.addHandler=function(t,e){r.push({context:e,handler:t})},this.removeHandler=function(t,e){for(var n=0;n<r.length;n++)r[n].handler==t&&r[n].context==e&&r.splice(n,1)},this.removeAllHandlers=function(){r=[]},this.fire=function(n){for(var o=[t,e,n],i=0;i<r.length;i++)r[i].handler.apply(r[i].context,o)}},n.Invoker=function(t,n,o){var i=t,a=n,l=o,s={overrideApi:!1,context:null,fallback:null};this.go=function(t,n,o){var u;if(n=void 0!==n?Array.prototype.slice.apply(n):[],void 0===o&&(o=s),u=o.overrideApi?n.shift():l.apply(i),"string"!=typeof u)throw"API ID not available.";return void 0!==o.context&&null!==o.context&&n.push(o.context),"function"!=typeof o.fallback||r(u,a,t)?e(u,a,t,i,n):o.fallback.apply(i,n)}},n.util={merge:function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t.hasOwnProperty(r)&&"object"==typeof t[r]&&"object"==typeof e[r]?n.util.merge(t[r],e[r]):t[r]=e[r])},$m:function(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if("string"==typeof r&&(r=document.getElementById(r)),1==arguments.length)return r;t.push(r)}return t},loadScript:function(t,e){var r=document.createElement("script");if(r.type="text/javascript",r.src=t,e)if(r.addEventListener)r.addEventListener("load",e,!0);else if(r.attachEvent){var n=!1;r.attachEvent("onreadystatechange",function(){n||"complete"!==document.readyState||(n=!0,e())})}var o=document.getElementsByTagName("head")[0];o.appendChild(r)},convertLatLonXY_Yahoo:function(t,e){var r=1<<26-e,n=r/360,o=r/(2*Math.PI),i=new YCoordPoint(r/2,r/2),a=new YCoordPoint;a.x=Math.floor(i.x+t.lon*n);var l=Math.sin(t.lat*Math.PI/180);return a.y=Math.floor(i.y+.5*Math.log((1+l)/(1-l))*-o),a},loadStyle:function(t){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)},getStyle:function(t,e){var r;return t.currentStyle?r=t.currentStyle[e]:window.getComputedStyle&&(r=window.getComputedStyle(t,"").getPropertyValue(e)),r},lonToMetres:function(t,e){return t*(111200*Math.cos(e*(Math.PI/180)))},metresToLon:function(t,e){return t/(111200*Math.cos(e*(Math.PI/180)))},KMToMiles:function(t){return t/1.609344},milesToKM:function(t){return 1.609344*t},getDegreesFromGoogleZoomLevel:function(t,e){return 360*t/Math.pow(2,e+8)},getGoogleZoomLevelFromDegrees:function(t,e){return n.util.logN(360*t/e,2)-8},logN:function(t,e){return Math.log(t)/Math.log(e)},getAvailableProviders:function(){var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e},stringFormat:function(t){var e=/\{\d+\}/g,r=Array.prototype.slice.apply(arguments);return r.shift(),t.replace(e,function(t){var e=t.slice(1,-1);return r[e]})},traverse:function(t){var e=Array.prototype.slice.apply(arguments);e.shift();for(var r=t;null!=r&&e.length>0;){var n=e.shift();r=n(r)}}},n.util.Color=function(){3==arguments.length?(this.red=arguments[0],this.green=arguments[1],this.blue=arguments[2]):1==arguments.length&&this.setHexColor(arguments[0])},n.util.Color.prototype.reHex=/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,n.util.Color.prototype.setHexColor=function(t){var e=t.match(this.reHex);if(!e)throw"Invalid HEX color format, expected #000, 000, #000000 or 000000";t=e[1],3==t.length&&(t=t.replace(/\w/g,function(t){return t.concat(t)})),this.red=parseInt(t.substr(0,2),16),this.green=parseInt(t.substr(2,2),16),this.blue=parseInt(t.substr(4,2),16)},n.util.Color.prototype.getHexColor=function(){var t=this.blue|this.green<<8|this.red<<16,e=t.toString(16).toUpperCase();return e.length<6&&(e="0"+e),"#"+e}}();